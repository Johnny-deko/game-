<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Міні-гра: Ухилися від перешкод</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: #0d1b2a;
      color: #fff;
      text-align: center;
    }
    canvas {
      background: #1b263b;
      border: 2px solid #415a77;
      display: block;
      margin: 20px auto;
      border-radius: 10px;
    }
    .controls {
      display: flex;
      justify-content: center;
      gap: 15px;
      margin-top: 10px;
    }
    button {
      padding: 10px 15px;
      font-size: 16px;
      cursor: pointer;
      border-radius: 6px;
      border: none;
    }
  </style>
</head>
<body>
  <h1>Міні-гра: Ухилися!</h1>
  <p>Уникай червоних перешкод. Керування: стрілки ← →</p>

  <canvas id="game" width="500" height="300"></canvas>

  <div class="controls">
    <button id="startBtn">Старт</button>
    <button id="stopBtn">Пауза</button>
    <button id="resetBtn">Скинути</button>
  </div>

<script>
let canvas = document.getElementById('game');
let ctx = canvas.getContext('2d');

let player = { x: 230, y: 250, w: 40, h: 40, speed: 4 };
let blocks = [];
let gameRunning = false;
let anim = null;
let score = 0;
let keys = {};

function spawnBlock() {
  blocks.push({ x: Math.random() * 460, y: -20, w: 30, h: 30, speed: 2 + Math.random() * 3 });
}

function movePlayer() {
  if (keys['ArrowLeft'] && player.x > 0) player.x -= player.speed;
  if (keys['ArrowRight'] && player.x < canvas.width - player.w) player.x += player.speed;
}

function updateBlocks() {
  for (let b of blocks) b.y += b.speed;
  blocks = blocks.filter(b => b.y < 350);
}

function checkCollision() {
  for (let b of blocks) {
    if (player.x < b.x + b.w && player.x + player.w > b.x && player.y < b.y + b.h && player.y + player.h > b.y) {
      stopGame();
      alert("Гру завершено! Твій рахунок: " + score);
    }
  }
}

function draw() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  ctx.fillStyle = "#4cc9f0";
  ctx.fillRect(player.x, player.y, player.w, player.h);

  ctx.fillStyle = "#e63946";
  for (let b of blocks) ctx.fillRect(b.x, b.y, b.w, b.h);

  ctx.fillStyle = "white";
  ctx.fillText("Рахунок: " + score, 10, 20);
}

function gameLoop() {
  if (!gameRunning) return;

  movePlayer();
  updateBlocks();
  checkCollision();
  draw();

  if (Math.random() < 0.03) spawnBlock();

  score++;

  anim = requestAnimationFrame(gameLoop);
}

function startGame() {
  if (!gameRunning) {
    gameRunning = true;
    gameLoop();
  }
}

function stopGame() {
  gameRunning = false;
  cancelAnimationFrame(anim);
}

function resetGame() {
  stopGame();
  player.x = 230;
  blocks = [];
  score = 0;
  draw();
}

document.addEventListener('keydown', e => keys[e.key] = true);
document.addEventListener('keyup', e => keys[e.key] = false);

document.getElementById('startBtn').onclick = startGame;
document.getElementById('stopBtn').onclick = stopGame;
document.getElementById('resetBtn').onclick = resetGame;

draw();
</script>
</body>
</html>
